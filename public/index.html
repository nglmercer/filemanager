<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
<!--     <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'">
 -->    <link href="./styles.css" rel="stylesheet">
    <script src="./webcomponents/webc.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.1/socket.io.min.js" integrity="sha512-sDJv0a9w7m0w8a+t7/1/3/e/5/r/c/a/g/i/o/u/y/t/s/a/n/d/e/r/i/v/a/l/i/n/g/m/e/" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <title>Hello World!</title>
    <style>
      body {
        background-color: #333;
        color: #fff;
      }
      #drop-area {
        border: 2px dashed #ccc;
        border-radius: 5px;
        padding: 20px;
        text-align: center;
        font-size: 20px;
        width: 100%;
        height: 100%;
        margin: auto;
      }
    </style>
  </head>
  <body>
    <div id="drop-area" ></div>
    Node.js  <span id="node-version"></span>,
    Chromium <span id="chrome-version"></span>,
    Electron <span id="electron-version"></span>.
    <button id="openModal" class="modal-trigger" onclick="document.getElementById('Configurations').open()">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 0 1 1.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.559.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.894.149c-.424.07-.764.383-.929.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 0 1-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.398.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 0 1-.12-1.45l.527-.737c.25-.35.272-.806.108-1.204-.165-.397-.506-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.108-1.204l-.526-.738a1.125 1.125 0 0 1 .12-1.45l.773-.773a1.125 1.125 0 0 1 1.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894Z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
        </svg>
        
  </button>
  <custom-modal modal-type="form" id="Configurations">
    <drag-and-drop></drag-and-drop>
    <grid-container id="myGrid"></grid-container>

    <div id="galeria-elementos"></div>

  </custom-modal>
    <!-- You can also require other files to run in this process -->
    <template id="galeria-elementos-template">
      <style>
          :host {
              display: block;
              font-family: Arial, sans-serif;
          }
          .container {
              max-width: 1200px;
              margin: 0 auto;
              padding: 20px;
          }
          .search-bar {
              width: 100%;
              padding: 10px;
              margin-bottom: 20px;
              font-size: 16px;
          }
          .gallery {
              display: grid;
              grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
              gap: 20px;
              overflow: auto;
              max-height: 90dvh;
          }
          .item {
              border: 1px solid #ccc;
              border-radius: 8px;
              padding: 10px;
              text-align: center;
              position: relative;
          }
          .item-icon {
              font-size: 48px;
              margin-bottom: 10px;
          }
          .item-name {
              font-weight: bold;
              margin-bottom: 5px;
          }
          .item-info {
              font-size: 12px;
              color: #aaa;
          }
          .item-tooltip {
              position: absolute;
              background-color: #333;
              color: #fff;
              padding: 5px;
              border-radius: 4px;
              font-size: 12px;
              bottom: 100%;
              left: 50%;
              transform: translateX(-50%);
              white-space: nowrap;
              opacity: 0;
              transition: opacity 0.3s;
              pointer-events: none;
          }
          .item:hover .item-tooltip {
              opacity: 1;
          }
          .delete-btn {
              position: absolute;
              top: 5px;
              right: 5px;
              background-color: #ff4444;
              color: white;
              border: none;
              border-radius: 50%;
              width: 20px;
              height: 20px;
              font-size: 12px;
              cursor: pointer;
          }
      </style>
      <div class="container">
          <input type="text" class="search-bar" placeholder="Buscar elementos...">
          <div class="gallery"></div>
      </div>
  </template>
    <script src="./renderer.js"></script>
    <script>
        const grid = document.getElementById('myGrid');
        const dropfile = document.querySelector('drag-and-drop');
        dropfile.addEventListener('DroppedFile', (event) => {
            console.log('File dropped:', event.detail.file);
            addfilesitems();  
        });
        function addfilesitems() {
          grid.clearAll();
          setTimeout(() => {
            const files = JSON.parse(localStorage.getItem('filePaths'));
            console.log(files);
            files.forEach(file => {
            grid.addItem(file.nombre, file.path, file.mediaType || file.type,file);
            console.log(file)});
          }, 250);
        }
        grid.toggleDarkMode(true);
      ( async () => {
        addfilesitems()

      })()
      const allItems = grid.getAllItems();
      console.log(allItems);

      // Escuchar eventos de eliminaciÃ³n
      grid.addEventListener('itemRemoved', (event) => {
          console.log('Elemento eliminado:', event.detail.id);
      });
      grid.addEventListener('itemClick', (event) => {
          console.log('Elemento clickeado:', event.detail);
      });
    </script>

  </body>
</html>
